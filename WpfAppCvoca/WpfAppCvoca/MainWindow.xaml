<Window x:Class="WpfAppCvoca.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:WpfAppCvoca.Converters"
        xmlns:steps="clr-namespace:WpfAppCvoca.Views.Steps"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        Title="Cvoca Dashboard"
        WindowStartupLocation="Manual"
        WindowStyle="None"
        Loaded="Window_Loaded" ResizeMode="CanResize" ShowInTaskbar="True">
    <WindowChrome.WindowChrome>
        <shell:WindowChrome CaptionHeight="0" ResizeBorderThickness="6" GlassFrameThickness="0" UseAeroCaptionButtons="False" />
    </WindowChrome.WindowChrome>
    <Window.Resources>
        <converters:StepEqualsConverter x:Key="StepEqualsConverter" />
        <converters:BoolToThemeTextConverter x:Key="BoolToThemeTextConverter" />
    </Window.Resources>

    <Grid Style="{StaticResource MainGrid}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />     <!-- Title Bar -->
            <RowDefinition Height="Auto" />     <!-- Book Name + Show All -->
            <RowDefinition Height="Auto" />     <!-- Day / Pass -->
            <RowDefinition Height="*" />        <!-- Step Views -->
            <RowDefinition Height="Auto" />     <!-- Status Bar -->
        </Grid.RowDefinitions>

        <!-- Custom Title Bar -->
        <Border Grid.Row="0" Padding="0" Style="{StaticResource TitlebarBorder}">
            <Grid MouseLeftButtonDown="TitleBar_MouseLeftButtonDown" Style="{StaticResource TitlebarGrid}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Text="Cvoca Dashboard" Style="{StaticResource PageTitleText}" />

                <Button Grid.Column="1" Width="30" Height="30" Content="{Binding Theme.IsDarkMode, Converter={StaticResource BoolToThemeTextConverter}}" 
                        Command="{Binding Theme.ToggleThemeCommand}"/>
                <Button Grid.Column="2" Width="30" Height="30" Content="─" Click="BtnMinimize_Click" />
                <Button Grid.Column="3" Width="30" Height="30" Content="▢" Click="BtnMaximize_Click" />
                <Button Grid.Column="4" Width="40" Height="30" Content="✕" Click="BtnClose_Click" />
            </Grid>
        </Border>

        <Border Grid.Row="1" Padding="8" Style="{StaticResource TitlebarBorder}" >
            <Grid Margin="0,0,0,2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />  <!-- 첫 줄: 책 이름 + Show All -->
                    <RowDefinition Height="Auto" />  <!-- 둘째 줄: Day / Pass -->
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />  <!-- 라벨/텍스트 -->
                    <ColumnDefinition Width="*"   />  <!-- 중간 여유 공간 -->
                    <ColumnDefinition Width="Auto" />  <!-- 버튼/콤보박스 -->
                    <ColumnDefinition Width="Auto" />  <!-- 콤보박스/추가 -->
                </Grid.ColumnDefinitions>
                <!-- 첫 줄: 책 이름 + Show All 버튼 -->
                <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding DatabaseName}" 
                           FontWeight="Bold" FontSize="14" 
                           Foreground="{Binding Theme.ForegroundColor}" />
                <!-- <Button Grid.Row="0" Grid.Column="2" Content="{Binding Theme.IsDarkMode, Converter={StaticResource BoolToThemeTextConverter}}" 
                        Command="{Binding Theme.ToggleThemeCommand}"/> -->
                <Button Grid.Row="0" Grid.Column="3" Content="Home" Command="{Binding ChangeStepCommand}" CommandParameter="0"/>

                <!-- 둘째 줄: Day / Pass -->
                <TextBlock Grid.Row="1" Grid.Column="0" Text="Day" 
                           VerticalAlignment="Center" 
                           Foreground="{Binding Theme.ForegroundColor}" />
                <ComboBox Grid.Row="1" Grid.Column="1"
                            x:Name="CmbDay"
                            Width="80"
                            ItemsSource="{Binding Days}"
                            SelectedItem="{Binding SelectedDay}"
                            Style="{StaticResource ThemedComboBox}" />
                <TextBlock Grid.Row="1" Grid.Column="2" Text="Pass:" 
                           VerticalAlignment="Center" 
                           Foreground="{Binding Theme.ForegroundColor}" />
                <ComboBox Grid.Row="1" Grid.Column="3"
                            Width="60"
                            ItemsSource="{Binding Passes}"
                            SelectedItem="{Binding SelectedPass}"
                            Style="{StaticResource ThemedComboBox}" />
            </Grid>
        </Border>

        <Border Grid.Row="2" Padding="4,4,4,4" 
                BorderBrush="{Binding Theme.BorderColor}" 
                BorderThickness="0,0,0,1"
                Background="{Binding Theme.SecondaryBackgroundColor}">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <ToggleButton Content="1. Spellings" Width="110" Margin="2,0"
                              IsChecked="{Binding CurrentStep, Mode=OneWay, Converter={StaticResource StepEqualsConverter}, ConverterParameter=1}"
                              Command="{Binding ChangeStepCommand}" CommandParameter="1"
                              Background="{Binding Theme.ToggleButtonBackgroundColor}"
                              Foreground="{Binding Theme.ToggleButtonForegroundColor}" />
                <ToggleButton Content="2. Meanings" Width="110" Margin="2,0"
                              IsChecked="{Binding CurrentStep, Mode=OneWay, Converter={StaticResource StepEqualsConverter}, ConverterParameter=2}"
                              Command="{Binding ChangeStepCommand}" CommandParameter="2"
                              Background="{Binding Theme.ToggleButtonBackgroundColor}"
                              Foreground="{Binding Theme.ToggleButtonForegroundColor}" />
                <ToggleButton Content="3. Examples" Width="110" Margin="2,0"
                              IsChecked="{Binding CurrentStep, Mode=OneWay, Converter={StaticResource StepEqualsConverter}, ConverterParameter=3}"
                              Command="{Binding ChangeStepCommand}" CommandParameter="3"
                              Background="{Binding Theme.ToggleButtonBackgroundColor}"
                              Foreground="{Binding Theme.ToggleButtonForegroundColor}" />
            </StackPanel>
        </Border>

        <Grid Grid.Row="3">
            <Border x:Name="PanelStepShowAll" Padding="8" 
                    Background="{Binding Theme.SecondaryBackgroundColor}"
                    Visibility="{Binding PanelStepShowAllVisibility}">
                <steps:Step0ShowAllView x:Name="Step0View" />
            </Border>
            <Border x:Name="PanelStepSpellings" Padding="8" 
                    Background="{Binding Theme.SecondaryBackgroundColor}"
                    Visibility="{Binding PanelStepSpellingsVisibility}">
                <steps:Step1SpellingsView x:Name="Step1View" />
            </Border>
            <Border x:Name="PanelStepMeanings" Padding="8" 
                    Background="{Binding Theme.SecondaryBackgroundColor}"
                    Visibility="{Binding PanelStepMeaningsVisibility}">
                <steps:Step2MeaningsView x:Name="Step2View" />
            </Border>
            <Border x:Name="PanelStepExamples" Padding="8" 
                    Background="{Binding Theme.SecondaryBackgroundColor}"
                    Visibility="{Binding PanelStepExamplesVisibility}">
                <steps:Step3ExamplesView x:Name="Step3View" />
            </Border>
        </Grid>

        <StatusBar Grid.Row="4" Background="{Binding Theme.StatusBarBackgroundColor}">
            <StatusBarItem>
                <TextBlock Text="{Binding DefaultSummary}" 
                           Foreground="{Binding Theme.ForegroundColor}" />
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="TxtStatusBar" Text="{Binding StatusBarText}" 
                           TextAlignment="Right" 
                           Foreground="{Binding Theme.ForegroundColor}" />
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
